<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="normalize.css" rel="stylesheet" type="text/css"> <!--Normalize CSS-->
    <link href="index.css" rel="stylesheet" type="text/css" />

    <title>Login Page</title>
</head>
<body>
    <div class="form">
        <center>
            <input type="email" placeholder="Enter student email" id="email" required><br>
            <input type="password" placeholder="Enter password" id="password" required><br><br>
            <button id="loginBtn"><a href="ewaste.html" style="text-decoration:none; color: white;">Click me to login!</a></button><br>
            <p style="color:white">Dont have an account? <em><a href="signUp.html" style="text-decoration: none; color:white">Sign up here!</a></em></p>
        </center>   
    </div>

    <div class="sourcecontainer" id="footer">
        <h3>Image sourced by <em><a href="https://hackaday.com/2019/02/20/the-woeful-world-of-worldwide-e-waste/" style="text-decoration:none; color:white">
            Hackaday</a></em></h3>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.0.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.1/firebase-auth.js"></script>

    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyAwG7RePlLNiGGfs61BttyXserKakBlq74",
          authDomain: "pfd-asg-1.firebaseapp.com",
          databaseURL: "https://pfd-asg-1-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "pfd-asg-1",
          storageBucket: "pfd-asg-1.appspot.com",
          messagingSenderId: "683817910117",
          appId: "1:683817910117:web:6bc464138c242c9853eb8c",
          measurementId: "G-PCCLL01552"
        };
      
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        document.getElementById('loginBtn').addEventListener('click', LoginUser)

        function LoginUser(){
            let email = document.getElementById('email').value
            let password = document.getElementById('password').value

            firebase.auth().signInWithEmailAndPassword(email, password).catch(e=>{
                console.log(e)

                var errorCode = error.code;
                var errorMessage = error.message;

                window.alert("Error : " + errorMessage);
            })
        }

        function showUserDetails(user){
            document.getElementById('userDetails').innerHTML = '<p>Logged in successfully with ${user.email}<p>'
        }

        firebase.auth().onAuthStateChanged(user=>{
            if(user){
                console.log(user)
            }
        })

        firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            // User is signed in.
            window.location = './ewaste.html';
            console.log(user)
            }
        });

        /*
        firebase.auth().onAuthStateChanged(function(user) {
            if (!user) {
                // User is signed in.
                window.location = './index.html';
            }
        });
        */

      </script>
       
</body>
</html>